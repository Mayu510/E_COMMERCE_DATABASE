CREATE DATABASE ECOMMERCE;

USE ECOMMERCE;

-- CUSTOMERS
DROP TABLE IF EXISTS CUSTOMERS;
CREATE TABLE CUSTOMERS (
    CUSTOMER_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    CUSTOMER_NAME VARCHAR(100) NOT NULL,
    CUSTOMER_CITY VARCHAR(100),
    REGISTERED_DATE  DATE,
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO CUSTOMERS (CUSTOMER_NAME, CUSTOMER_CITY, REGISTERED_DATE) VALUES
  ('MAHESH KSHIRSAGAR', 'LOHEGAON', '2020-07-30'),
  ('GANESH KSHIRSAGAR', 'DOMBIVLI', '2021-09-21'),
  ('DARSHAN KSHIRSAGAR', 'KOPAR', '2024-07-03'),
  ('SHRADDHA KSHIRSAGAR', 'DIVA', '2020-01-31'),
  ('SHUBHAM MULE', 'VEET', '2023-09-18'),
  ('RAJ DEOTARSE', 'SHRIGONDA', '2022-07-09'),
  ('SACHIN BORUDE', 'PEDGAON', '2020-09-30'),
  ('SHAHID HAKIM', 'HADAPSAR', '2025-10-03'),
  ('OM SUDRIK', 'DHANORI', '2023-02-13'),
  ('BHUSHAN TARTE', 'KOKAN GAON', '2024-03-29');

-- -------------------------
-- CATEGORY

DROP TABLE IF EXISTS CATEGORY;
CREATE TABLE CATEGORY (
    CATEGORY_ID INT NOT NULL PRIMARY KEY,
    CATEGORY_NAME VARCHAR(50) NOT NULL
);

INSERT INTO CATEGORY (CATEGORY_ID, CATEGORY_NAME) VALUES
  (1, 'ELECTRONICS'),
  (2, 'GROCERY'),
  (3, 'HOME APPLIANCES'),
  (4, 'CLOTHES');

-- -------------------------
-- PRODUCT

DROP TABLE IF EXISTS PRODUCT;
CREATE TABLE PRODUCT (
    PRODUCT_ID INT NOT NULL PRIMARY KEY,
    PRODUCT_NAME VARCHAR(100) NOT NULL,
    PRODUCT_CATEGORY INT NOT NULL,
    PRODUCT_PRICE DECIMAL(10,2) NOT NULL,
    STOCK_QUANTITY INT NOT NULL DEFAULT 0,
    CONSTRAINT fk_product_category FOREIGN KEY (PRODUCT_CATEGORY)
        REFERENCES CATEGORY(CATEGORY_ID)
        ON DELETE RESTRICT
        ON UPDATE CASCADE
);

INSERT INTO PRODUCT (PRODUCT_ID, PRODUCT_NAME, PRODUCT_CATEGORY, PRODUCT_PRICE, STOCK_QUANTITY) VALUES
-- ELECTRONICS (1)
  (101, 'Smartphone',          1, 15000.00, 25),
  (102, 'Laptop',              1, 52000.00, 15),
  (103, 'Smartwatch',          1,  7000.00, 30),
  (104, 'Bluetooth Speaker',   1,  2500.00, 40),
  (105, 'Headphones',          1,  1800.00, 35),

-- GROCERY (2)
  (201, 'Rice 10kg',           2,   550.00, 80),
  (202, 'Sugar 5kg',           2,   280.00,100),
  (203, 'Wheat Flour 10kg',    2,   500.00, 60),
  (204, 'Cooking Oil 1L',      2,   160.00,120),
  (205, 'Tea Pack',            2,   200.00, 90),

-- HOME APPLIANCES (3)
  (301, 'Mixer Grinder',       3,  3200.00, 25),
  (302, 'Electric Kettle',     3,  1200.00, 50),
  (303, 'Ceiling Fan',         3,  2800.00, 30),
  (304, 'Iron',                3,  1600.00, 40),
  (305, 'Air Cooler',          3,  8500.00, 10),

-- CLOTHES (4)
  (401, 'Men T-Shirt',         4,   600.00, 60),
  (402, 'Women Jeans',         4,  1200.00, 45),
  (403, 'Men Formal Shirt',    4,   900.00, 50),
  (404, 'Women Kurti',         4,  1100.00, 55),
  (405, 'Jacket',              4,  2500.00, 20);

-- -------------------------
-- ORDERS

DROP TABLE IF EXISTS ORDERS;
CREATE TABLE ORDERS (
    ORDER_ID INT NOT NULL PRIMARY KEY,
    ORDER_DATE DATE NOT NULL,
    CUSTOMER_ID INT NOT NULL,
    ORDER_STATUS ENUM('COMPLETED', 'INCOMPLETE') NOT NULL DEFAULT 'INCOMPLETE',
    CREATED_AT TIMESTAMP    DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_orders_customer FOREIGN KEY (CUSTOMER_ID)
        REFERENCES CUSTOMERS(CUSTOMER_ID)
        ON DELETE RESTRICT
        ON UPDATE CASCADE
);

INSERT INTO ORDERS (ORDER_ID, CUSTOMER_ID, ORDER_DATE, ORDER_STATUS) VALUES
  (1001, 1, '2024-12-28', 'COMPLETED'),
  (1002, 2, '2025-01-05', 'COMPLETED'),
  (1003, 3, '2025-01-12', 'INCOMPLETE'),
  (1004, 1, '2025-01-25', 'COMPLETED'),
  (1005, 4, '2025-02-03', 'COMPLETED'),
  (1006, 5, '2025-02-15', 'INCOMPLETE'),
  (1007, 6, '2025-02-20', 'COMPLETED'),
  (1008, 2, '2025-03-01', 'COMPLETED'),
  (1009, 3, '2025-03-09', 'COMPLETED'),
  (1010, 7, '2025-03-17', 'INCOMPLETE'),
  (1011, 8, '2025-03-28', 'COMPLETED'),
  (1012, 1, '2025-04-04', 'COMPLETED'),
  (1013, 9, '2025-04-10', 'COMPLETED'),
  (1014, 10, '2025-04-22', 'INCOMPLETE'),
  (1015, 6, '2025-04-30', 'COMPLETED'),
  (1016, 5, '2025-05-06', 'COMPLETED'),
  (1017, 2, '2025-05-18', 'INCOMPLETE'),
  (1018, 3, '2025-05-23', 'COMPLETED'),
  (1019, 4, '2025-06-02', 'COMPLETED'),
  (1020, 1, '2025-06-08', 'COMPLETED');

-- -------------------------
-- ORDER_ITEMS 

DROP TABLE IF EXISTS ORDER_ITEMS;
CREATE TABLE ORDER_ITEMS (
    ORDER_ITEM_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    ORDER_ID INT NOT NULL,
    PRODUCT_ID INT NOT NULL,
    QUANTITY INT NOT NULL DEFAULT 1,
    UNIT_PRICE DECIMAL(10,2) NOT NULL,
    CONSTRAINT fk_oi_order FOREIGN KEY (ORDER_ID)
        REFERENCES ORDERS(ORDER_ID)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT fk_oi_product FOREIGN KEY (PRODUCT_ID)
        REFERENCES PRODUCT(PRODUCT_ID)
        ON DELETE RESTRICT
        ON UPDATE CASCADE
);

-- Example sample ORDER_ITEMS inserts (demo purpose)

INSERT INTO ORDER_ITEMS (ORDER_ID, PRODUCT_ID, QUANTITY, UNIT_PRICE) VALUES
  (1001, 101, 1, 15000.00),
  (1001, 105, 2, 1800.00),
  (1002, 201, 3,   550.00),
  (1004, 102, 1, 52000.00),
  (1012, 104, 1,  2500.00),
  (1019, 401, 2,   600.00),
  (1020, 103, 1,  7000.00);

-- -------------------------
-- Useful indexes (improve query performance)

CREATE INDEX idx_product_category ON PRODUCT (PRODUCT_CATEGORY);
CREATE INDEX idx_orders_customer ON ORDERS (CUSTOMER_ID);
CREATE INDEX idx_orderitems_product ON ORDER_ITEMS (PRODUCT_ID);

COMMIT;
